<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Блоки - RoyalPark Admin</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/admin.css">
    
    <style>
        .content-wrapper {
            padding: 0 32px 32px 32px;
        }
        
        .block-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 2.5rem;
            margin: 0 0 8px 0;
            font-weight: 700;
        }
        
        .stat-card p {
            margin: 0;
            opacity: 0.9;
            font-size: 0.95rem;
        }
        
        .block-map-container {
            background: white;
            border-radius: 15px;
            padding: 32px;
            margin: 24px 0px 32px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .block-details {
            margin-top: 32px;
        }
        
        .block-details .card {
            background: white;
            border-radius: 15px;
            padding: 32px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .complex-map {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 15px;
            padding: 40px;
            min-height: 500px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            align-items: center;
            justify-items: center;
        }
        
        .block-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 30px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            width: 100%;
            max-width: 250px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        
        .block-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }
        
        .block-card.active {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
        
        .block-name {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .block-info {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .block-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            font-size: 2rem;
            color: #667eea;
            margin: 0;
        }
        
        .stat-card p {
            color: #6c757d;
            margin: 5px 0 0 0;
        }
        
        .block-details {
            margin-top: 30px;
        }
        
        .map-placeholder {
            text-align: center;
            color: #6c757d;
            padding: 60px;
        }
        
        .map-placeholder i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="logo-icon">
                        <img src="/images/royal_park_baku_logo.svg" alt="RoyalPark Logo" class="sidebar-logo-image">
                    </div>
                    <div class="logo-text">
                        <h2>RoyalPark</h2>
                        <p>Admin Panel</p>
                    </div>
                </div>
                <button class="toggle-sidebar" id="toggleSidebar">
                    <svg width="20" height="20" fill="currentColor">
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </button>
            </div>

            <nav class="nav-menu">
                <div class="nav-section">
                    <div class="nav-section-title">Главное</div>
                    <a href="/admin/dashboard.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-dashboard"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Панель управления</span>
                    </a>
                    <a href="/admin/analytics.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-analytics"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Аналитика</span>
                    </a>
                    <a href="/admin/reports.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-reports"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Отчеты</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Управление</div>
                    <a href="/admin/blocks.html" class="nav-item active">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-buildings"></use>
                            </svg>
                        </span>
                        <span class="nav-text" data-i18n="nav_blocks">Блоки</span>
                    </a>
                    <a href="/admin/tariffs.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-payments"></use>
                            </svg>
                        </span>
                        <span class="nav-text" data-i18n="nav_tariffs">Тарифы</span>
                    </a>
                    <a href="/admin/residents.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-users"></use>
                            </svg>
                        </span>
                        <span class="nav-text" data-i18n="nav_residents">Резиденты</span>
                        <span class="nav-badge">245</span>
                    </a>
                    <a href="/admin/tenants.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-apartments"></use>
                            </svg>
                        </span>
                        <span class="nav-text" data-i18n="nav_tenants">Жители</span>
                    </a>
                    <a href="/admin/readings.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-meters"></use>
                            </svg>
                        </span>
                        <span class="nav-text" data-i18n="nav_readings">Показатели</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Финансы</div>
                    <a href="/admin/payments.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-payments"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Платежи</span>
                    </a>
                    <a href="/admin/invoices.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-bills"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Счета</span>
                        <span class="nav-badge">12</span>
                    </a>
                    <a href="/admin/debts.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-debts"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Задолженности</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Обслуживание</div>
                    <a href="/admin/repair-requests.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-repairs"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Заявки на ремонт</span>
                        <span class="nav-badge">8</span>
                    </a>
                    <a href="/admin/inspections.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-inspections"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Проверки</span>
                    </a>
                    <a href="/admin/staff.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-staff"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Персонал</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Система</div>
                    <a href="/admin/settings.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-settings"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Настройки</span>
                    </a>
                    <a href="/admin/logs.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-logs"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Логи</span>
                    </a>
                    <a href="/admin/backup.html" class="nav-item">
                        <span class="nav-icon">
                            <svg width="20" height="20" fill="currentColor">
                                <use href="/images/icons.svg#icon-backup"></use>
                            </svg>
                        </span>
                        <span class="nav-text">Резервное копирование</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="page-title">
                    <h1>Блоки комплекса</h1>
                    <div class="page-breadcrumb">
                        <span class="breadcrumb-item">Управление</span>
                        <span>›</span>
                        <span class="breadcrumb-item">Блоки</span>
                    </div>
                </div>

                <div class="top-bar-actions">
                    <div class="search-box">
                        <span class="search-icon">
                            <svg width="16" height="16" fill="currentColor">
                                <use href="/images/icons.svg#icon-inspections"></use>
                            </svg>
                        </span>
                        <input type="text" placeholder="Поиск...">
                    </div>

                    <button class="notification-btn">
                        <svg width="20" height="20" fill="currentColor">
                            <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
                        </svg>
                        <span class="notification-badge">3</span>
                    </button>

                    <div class="user-profile">
                        <div class="user-avatar">АД</div>
                        <div class="user-info">
                            <div class="user-name">Администратор</div>
                            <div class="user-role">Системный администратор</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="content-wrapper">
                <!-- Stats -->
                <div class="block-stats">
                    <div class="stat-card">
                        <h3>5</h3>
                        <p>Всего блоков</p>
                    </div>
                    <div class="stat-card">
                        <h3>420</h3>
                        <p>Всего квартир</p>
                    </div>
                    <div class="stat-card">
                        <h3>98%</h3>
                        <p>Заселенность</p>
                    </div>
                    <div class="stat-card">
                        <h3>1,850</h3>
                        <p>Жителей</p>
                    </div>
                </div>

                <!-- Complex Map -->
                <div class="block-map-container">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0">План комплекса Royal Park</h2>
                        <div class="d-flex gap-2">
                            <input type="text" id="newBlockName" class="form-control" placeholder="Название нового блока" style="width: 250px;">
                            <button class="btn btn-success" onclick="createBlock()">
                                <i class="bi bi-plus-lg"></i> Создать блок
                            </button>
                        </div>
                    </div>
                    
                    <div class="complex-map" id="complexMap">
                        <div class="block-card" data-block="A" onclick="selectBlock('A')">
                            <div class="block-name">Блок A</div>
                            <div class="block-info">
                                <div>10 этажей</div>
                                <div>80 квартир</div>
                                <div>320 жителей</div>
                            </div>
                        </div>
                        
                        <div class="block-card" data-block="B" onclick="selectBlock('B')">
                            <div class="block-name">Блок B</div>
                            <div class="block-info">
                                <div>10 этажей</div>
                                <div>80 квартир</div>
                                <div>315 жителей</div>
                            </div>
                        </div>
                        
                        <div class="block-card" data-block="K" onclick="selectBlock('K')">
                            <div class="block-name">Блок K</div>
                            <div class="block-info">
                                <div>12 этажей</div>
                                <div>96 квартир</div>
                                <div>385 жителей</div>
                            </div>
                        </div>
                        
                        <div class="block-card" data-block="X" onclick="selectBlock('X')">
                            <div class="block-name">Блок X</div>
                            <div class="block-info">
                                <div>15 этажей</div>
                                <div>120 квартир</div>
                                <div>480 жителей</div>
                            </div>
                        </div>
                        
                        <div class="block-card" data-block="Z" onclick="selectBlock('Z')">
                            <div class="block-name">Блок Z</div>
                            <div class="block-info">
                                <div>8 этажей</div>
                                <div>64 квартиры</div>
                                <div>256 жителей</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="map-placeholder mt-4">
                        <i class="bi bi-building"></i>
                        <p>Здесь будет отображен план комплекса Royal Park</p>
                        <small class="text-muted">Загрузите изображение плана комплекса</small>
                    </div>
                </div>

                <!-- Block Details -->
                <div class="block-details mt-4" id="blockDetails" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3 id="selectedBlockName">Детали блока</h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5>Основная информация</h5>
                                    <ul class="list-unstyled">
                                        <li><strong>Этажей:</strong> <span id="blockFloors">-</span></li>
                                        <li><strong>Квартир:</strong> <span id="blockApartments">-</span></li>
                                        <li><strong>Жителей:</strong> <span id="blockResidents">-</span></li>
                                        <li><strong>Заселенность:</strong> <span id="blockOccupancy">-</span></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h5>Быстрые действия</h5>
                                    <div class="d-flex flex-column gap-2">
                                        <button class="btn btn-success btn-sm" onclick="viewApartments()">
                                            <i class="bi bi-list"></i> Список квартир
                                        </button>
                                        <button class="btn btn-outline-primary btn-sm" onclick="viewResidents()">
                                            <i class="bi bi-people"></i> Список жителей
                                        </button>
                                        <button class="btn btn-outline-secondary btn-sm" onclick="viewMeters()">
                                            <i class="bi bi-speedometer"></i> Показатели счетчиков
                                        </button>
                                        <hr>
                                        <button class="btn btn-warning btn-sm" onclick="renameBlock()">
                                            <i class="bi bi-pencil"></i> Переименовать
                                        </button>
                                        <button class="btn btn-danger btn-sm" onclick="deleteBlock()">
                                            <i class="bi bi-trash"></i> Удалить блок
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Notifications -->
    <script src="/js/notifications.js"></script>
    
    <!-- Theme Management -->
    <script src="/js/theme.js"></script>
    
    <!-- Language Management -->
    <script src="/js/i18n.js"></script>
    <script src="/js/i18n-auto.js"></script>
    
    <!-- Custom JS -->
    <script src="/js/admin.js"></script>
    
    <script>
        let selectedBlock = null;
        
        function selectBlock(blockName) {
            selectedBlock = blockName;
            
            // Remove active class from all blocks
            document.querySelectorAll('.block-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to selected block
            document.querySelector(`[data-block="${blockName}"]`).classList.add('active');
            
            // Show block details
            document.getElementById('blockDetails').style.display = 'block';
            document.getElementById('selectedBlockName').textContent = `Блок ${blockName}`;
            
            // Sample data - replace with actual data
            const blockData = {
                'A': {floors: 10, apartments: 80, residents: 320, occupancy: '100%'},
                'B': {floors: 10, apartments: 80, residents: 315, occupancy: '98%'},
                'K': {floors: 12, apartments: 96, residents: 385, occupancy: '100%'},
                'X': {floors: 15, apartments: 120, residents: 480, occupancy: '100%'},
                'Z': {floors: 8, apartments: 64, residents: 256, occupancy: '100%'}
            };
            
            const data = blockData[blockName];
            if (data) {
                document.getElementById('blockFloors').textContent = data.floors;
                document.getElementById('blockApartments').textContent = data.apartments;
                document.getElementById('blockResidents').textContent = data.residents;
                document.getElementById('blockOccupancy').textContent = data.occupancy;
            }
            
            // Smooth scroll to details
            setTimeout(() => {
                document.getElementById('blockDetails').scrollIntoView({behavior: 'smooth'});
            }, 100);
        }
        
        function createBlock() {
            const blockName = document.getElementById('newBlockName').value.trim();
            
            if (!blockName) {
                showWarning('Пожалуйста, введите название блока');
                return;
            }
            
            // Create new block card
            const complexMap = document.getElementById('complexMap');
            const newBlockCard = document.createElement('div');
            newBlockCard.className = 'block-card';
            newBlockCard.setAttribute('data-block', blockName);
            newBlockCard.setAttribute('onclick', `selectBlock('${blockName}')`);
            newBlockCard.innerHTML = `
                <div class="block-name">Блок ${blockName}</div>
                <div class="block-info">
                    <div>0 этажей</div>
                    <div>0 квартир</div>
                    <div>0 жителей</div>
                </div>
            `;
            
            complexMap.appendChild(newBlockCard);
            
            // Clear input
            document.getElementById('newBlockName').value = '';
            
            // Show success message
            showSuccess(`Блок ${blockName} успешно создан!`);
            
            // TODO: Send to backend API
            // fetch('/api/blocks', {
            //     method: 'POST',
            //     headers: {'Content-Type': 'application/json'},
            //     body: JSON.stringify({name: blockName})
            // });
        }
        
        function renameBlock() {
            if (!selectedBlock) {
                showWarning('Пожалуйста, выберите блок');
                return;
            }
            
            showPrompt(`Введите новое название для блока ${selectedBlock}:`, selectedBlock, (newName) => {
                if (newName && newName.trim() !== '' && newName !== selectedBlock) {
                    const blockCard = document.querySelector(`[data-block="${selectedBlock}"]`);
                    if (blockCard) {
                        // Update block card
                        blockCard.setAttribute('data-block', newName);
                        blockCard.setAttribute('onclick', `selectBlock('${newName}')`);
                        blockCard.querySelector('.block-name').textContent = `Блок ${newName}`;
                        
                        // Update selected block name
                        document.getElementById('selectedBlockName').textContent = `Блок ${newName}`;
                        selectedBlock = newName;
                        
                        showSuccess(`Блок успешно переименован в ${newName}!`);
                        
                        // TODO: Send to backend API
                        // fetch(`/api/blocks/${selectedBlock}`, {
                        //     method: 'PUT',
                        //     headers: {'Content-Type': 'application/json'},
                        //     body: JSON.stringify({name: newName})
                        // });
                    }
                }
            });
        }
        
        function deleteBlock() {
            if (!selectedBlock) {
                showWarning('Пожалуйста, выберите блок');
                return;
            }
            
            showConfirm(`Вы уверены, что хотите удалить блок ${selectedBlock}?`, () => {
                const blockCard = document.querySelector(`[data-block="${selectedBlock}"]`);
                if (blockCard) {
                    // Remove block card with animation
                    blockCard.style.transition = 'all 0.3s ease';
                    blockCard.style.opacity = '0';
                    blockCard.style.transform = 'scale(0.8)';
                    
                    setTimeout(() => {
                        blockCard.remove();
                        
                        // Hide block details
                        document.getElementById('blockDetails').style.display = 'none';
                        selectedBlock = null;
                        
                        showSuccess('Блок успешно удален!');
                    }, 300);
                    
                    // TODO: Send to backend API
                    // fetch(`/api/blocks/${selectedBlock}`, {
                    //     method: 'DELETE'
                    // });
                }
            });
        }
        
        function viewApartments() {
            if (!selectedBlock) {
                showWarning('Пожалуйста, выберите блок');
                return;
            }
            showInfo(`Переход к списку квартир блока ${selectedBlock}...`);
            // TODO: Navigate to apartments page with block filter
            // window.location.href = `/admin/apartments.html?block=${selectedBlock}`;
        }
        
        function viewResidents() {
            if (!selectedBlock) {
                showWarning('Пожалуйста, выберите блок');
                return;
            }
            showInfo(`Переход к списку жителей блока ${selectedBlock}...`);
            // TODO: Navigate to residents page with block filter
            // window.location.href = `/admin/residents.html?block=${selectedBlock}`;
        }
        
        function viewMeters() {
            if (!selectedBlock) {
                showWarning('Пожалуйста, выберите блок');
                return;
            }
            showInfo(`Переход к показателям счетчиков блока ${selectedBlock}...`);
            // TODO: Navigate to meters page with block filter
            // window.location.href = `/admin/meters.html?block=${selectedBlock}`;
        }
    </script>
</body>
</html>

