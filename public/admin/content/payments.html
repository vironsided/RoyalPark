<style>
    /* Payments page styling similar to invoices */
    .payments-page {
        padding: 0;
    }

    /* Payments Filters Section */
    .payments-filters {
        background: #242831 !important;
        border: none !important;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: none !important;
    }

    .payments-filters-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        align-items: end;
        margin-bottom: 20px;
    }

    .payments-filters-group {
        display: flex;
        flex-direction: column;
    }

    .payments-filters-group label {
        font-weight: 600;
        margin-bottom: 8px;
        color: rgba(255, 255, 255, 0.8) !important;
        font-size: 0.9rem;
    }

    .payments-filters-group input,
    .payments-filters-group select {
        padding: 10px 15px;
        background: rgba(255, 255, 255, 0.05) !important;
        color: #fefefe !important;
        border: 1px solid rgba(255, 255, 255, 0.12) !important;
        border-radius: 8px;
        font-size: 0.95rem;
        transition: all 0.3s;
    }

    .payments-filters-group input:focus,
    .payments-filters-group select:focus {
        outline: none;
        border-color: #667eea !important;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        background: rgba(255, 255, 255, 0.08) !important;
    }

    .payments-filters-group input::placeholder {
        color: rgba(255, 255, 255, 0.35);
    }

    .payments-filters-group select option {
        background: #1f2432;
        color: #f6f7ff;
    }

    /* Date input wrapper */
    .date-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
        gap: 0;
    }

    .date-input-wrapper input[type="date"] {
        flex: 1;
        padding: 10px 50px 10px 15px;
        background: rgba(255, 255, 255, 0.05) !important;
        border: 1px solid rgba(255, 255, 255, 0.12) !important;
        border-radius: 8px 0 0 8px !important;
        color: #fefefe !important;
    }

    .date-input-wrapper .btn-calendar {
        position: absolute;
        right: 0;
        width: 48px;
        height: 100%;
        padding: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 0 8px 8px 0;
        color: #ffffff;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .payments-filters-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 15px;
    }

    .payments-filters-actions .btn-filter {
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 8px;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s;
    }

    .payments-filters-actions .btn-filter:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.2);
        color: #ffffff;
    }

    .payments-filters-actions .btn-accept-payment {
        padding: 10px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 8px;
        color: #ffffff;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .payments-filters-actions .btn-accept-payment:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
        transform: translateY(-1px);
    }

    /* Table styling */
    .payments-page .table thead th {
        padding: 12px 16px !important;
        text-align: left !important;
        vertical-align: middle !important;
        font-weight: 600 !important;
        color: rgba(255, 255, 255, 0.9) !important;
        background: rgba(102, 126, 234, 0.1) !important;
        border-bottom: 2px solid rgba(255, 255, 255, 0.12) !important;
    }

    [data-theme="dark"] .payments-page .table thead th,
    body[data-theme="dark"] .payments-page .table thead th,
    html[data-theme="dark"] .payments-page .table thead th {
        color: rgba(255, 255, 255, 0.9) !important;
        background: rgba(102, 126, 234, 0.1) !important;
        border-bottom: 2px solid rgba(255, 255, 255, 0.12) !important;
    }

    .payments-page .table tbody td {
        padding: 12px 16px !important;
        text-align: left !important;
        vertical-align: middle !important;
        color: #ffffff !important;
    }

    [data-theme="dark"] .payments-page .table tbody td,
    body[data-theme="dark"] .payments-page .table tbody td,
    html[data-theme="dark"] .payments-page .table tbody td {
        color: #ffffff !important;
    }

    /* Badge styles */
    .badge-advance {
        background: rgba(40, 167, 69, 0.2);
        color: #28a745;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.85rem;
        font-weight: 500;
    }

    /* Amount in red */
    .amount-red {
        color: #ff6b6b !important;
        font-weight: 600;
    }

    /* Card styling for payments table */
    .payments-page .card {
        background: rgba(36, 40, 49, 0.95) !important;
        border: none !important;
        border-radius: 15px !important;
    }

    [data-theme="dark"] .payments-page .card,
    body[data-theme="dark"] .payments-page .card,
    html[data-theme="dark"] .payments-page .card {
        background: rgba(36, 40, 49, 0.95) !important;
        border: none !important;
    }

    .payments-page .card-body {
        background: transparent !important;
        padding: 20px !important;
    }

    [data-theme="dark"] .payments-page .card-body,
    body[data-theme="dark"] .payments-page .card-body,
    html[data-theme="dark"] .payments-page .card-body {
        background: transparent !important;
        color: #e4e6eb !important;
    }

    /* Pagination styles */
    .table-pagination {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 20px;
        background: rgba(255, 255, 255, 0.05);
        border-top: none !important;
        border-radius: 0 0 15px 15px;
    }

    .pagination-controls {
        display: flex;
        gap: 8px;
        align-items: center;
    }

    .btn-pagination {
        min-width: 36px;
        height: 36px;
        padding: 0 12px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 8px;
        color: rgba(255, 255, 255, 0.7);
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
    }

    .btn-pagination:hover:not(:disabled) {
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.2);
        color: #ffffff;
    }

    .btn-pagination:disabled {
        opacity: 0.4;
        cursor: not-allowed;
    }

    .btn-pagination.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-color: #667eea;
        color: #ffffff;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .pagination-info {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
    }

    .pagination-per-page {
        display: flex;
        align-items: center;
        gap: 8px;
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
    }

    /* Custom dropdown for pagination */
    .custom-pag-select {
        position: relative;
        display: inline-block;
        min-width: 60px;
    }

    .custom-pag-select .select-btn {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 6px 12px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 6px;
        color: rgba(255, 255, 255, 0.9);
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.3s;
        min-width: 60px;
        user-select: none;
    }

    .custom-pag-select .select-btn:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.2);
    }

    .custom-pag-select .select-options {
        position: absolute;
        top: calc(100% + 8px);
        left: 0;
        background: #1f2432 !important;
        border: 1px solid rgba(255, 255, 255, 0.12) !important;
        border-radius: 8px !important;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5) !important;
        overflow: hidden;
        display: none;
        z-index: 10000;
        min-width: 100%;
    }

    .custom-pag-select.open .select-options {
        display: block;
    }

    .custom-pag-select .select-option {
        padding: 8px 12px;
        cursor: pointer;
        color: #f6f7ff !important;
        font-size: 0.9rem;
        transition: all 0.2s;
        background: #1f2432 !important;
    }

    .custom-pag-select .select-option:hover {
        background: #3b4261 !important;
        color: #ffffff !important;
    }

    .custom-pag-select .select-option.selected {
        background: #667eea !important;
        color: #ffffff !important;
        font-weight: 600;
    }

    /* Light theme styles */
    body:not([data-theme="dark"]) .payments-filters {
        background: rgba(255, 255, 255, 0.9) !important;
        border: none !important;
        color: #212529 !important;
    }

    body:not([data-theme="dark"]) .payments-filters-group label {
        color: #495057 !important;
    }

    body:not([data-theme="dark"]) .payments-filters-group input,
    body:not([data-theme="dark"]) .payments-filters-group select {
        background: #ffffff !important;
        color: #212529 !important;
        border: 1px solid #dee2e6 !important;
    }

    /* ФИНАЛЬНЫЙ ПРИОРИТЕТ - ГАРАНТИРОВАННО СЕРЫЙ ФОН В DARK THEME */
    /* Этот блок должен быть в самом конце, чтобы перекрыть ВСЕ остальные стили */
    [data-theme="dark"] .payments-filters,
    body[data-theme="dark"] .payments-filters,
    html[data-theme="dark"] .payments-filters,
    [data-theme="dark"] #spa-content .payments-filters,
    body[data-theme="dark"] #spa-content .payments-filters,
    html[data-theme="dark"] #spa-content .payments-filters,
    [data-theme="dark"] .content-wrapper .payments-filters,
    body[data-theme="dark"] .content-wrapper .payments-filters,
    html[data-theme="dark"] .content-wrapper .payments-filters {
        background: #242831 !important;
        background-color: #242831 !important;
        background-image: none !important;
        border: none !important;
        color: #e4e6eb !important;
    }

    [data-theme="dark"] .payments-filters-group label,
    body[data-theme="dark"] .payments-filters-group label,
    html[data-theme="dark"] .payments-filters-group label {
        color: rgba(255, 255, 255, 0.8) !important;
    }

    [data-theme="dark"] .payments-filters-group input,
    [data-theme="dark"] .payments-filters-group select,
    body[data-theme="dark"] .payments-filters-group input,
    body[data-theme="dark"] .payments-filters-group select,
    html[data-theme="dark"] .payments-filters-group input,
    html[data-theme="dark"] .payments-filters-group select {
        background: rgba(255, 255, 255, 0.05) !important;
        background-color: rgba(255, 255, 255, 0.05) !important;
        color: #fefefe !important;
        border: 1px solid rgba(255, 255, 255, 0.12) !important;
    }

    [data-theme="dark"] .payments-filters-group select option,
    body[data-theme="dark"] .payments-filters-group select option,
    html[data-theme="dark"] .payments-filters-group select option,
    [data-theme="dark"] #spa-content .payments-filters-group select option,
    body[data-theme="dark"] #spa-content .payments-filters-group select option,
    html[data-theme="dark"] #spa-content .payments-filters-group select option {
        background: #242831 !important;
        background-color: #242831 !important;
        color: #f6f7ff !important;
    }

    [data-theme="dark"] .payments-filters-group select option:hover,
    body[data-theme="dark"] .payments-filters-group select option:hover,
    html[data-theme="dark"] .payments-filters-group select option:hover {
        background: #3b4261 !important;
        color: #ffffff !important;
    }

    [data-theme="dark"] .payments-filters-group select option:checked,
    body[data-theme="dark"] .payments-filters-group select option:checked,
    html[data-theme="dark"] .payments-filters-group select option:checked {
        background: #667eea !important;
        color: #ffffff !important;
    }

    /* Белый цвет для плейсхолдера date input в темной теме */
    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-text,
    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-month-field,
    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-day-field,
    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-year-field,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-text,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-month-field,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-day-field,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-year-field,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-text,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-month-field,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-day-field,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-year-field {
        color: #ffffff !important;
    }

    [data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-text,
    [data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-month-field,
    [data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-day-field,
    [data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-year-field,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-text,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-month-field,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-day-field,
    body[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-year-field,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-text,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-month-field,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-day-field,
    html[data-theme="dark"] .date-input-wrapper input[type="date"]:invalid::-webkit-datetime-edit-year-field {
        color: #ffffff !important;
    }

    /* ФИНАЛЬНЫЙ ПРИОРИТЕТ - ГАРАНТИРОВАННО СЕРЫЙ ФОН В DARK THEME ДЛЯ PAYMENTS */
    /* Этот блок должен быть в самом конце, чтобы перекрыть ВСЕ остальные стили */
    [data-theme="dark"] .payments-page .card,
    body[data-theme="dark"] .payments-page .card,
    html[data-theme="dark"] .payments-page .card,
    [data-theme="dark"] #spa-content .payments-page .card,
    body[data-theme="dark"] #spa-content .payments-page .card,
    html[data-theme="dark"] #spa-content .payments-page .card {
        background: rgba(36, 40, 49, 0.95) !important;
        background-color: rgba(36, 40, 49, 0.95) !important;
        border: none !important;
    }

    [data-theme="dark"] .payments-page .card-body,
    body[data-theme="dark"] .payments-page .card-body,
    html[data-theme="dark"] .payments-page .card-body,
    [data-theme="dark"] #spa-content .payments-page .card-body,
    body[data-theme="dark"] #spa-content .payments-page .card-body,
    html[data-theme="dark"] #spa-content .payments-page .card-body {
        background: transparent !important;
        color: #e4e6eb !important;
    }

    [data-theme="dark"] .payments-page .table-pagination,
    body[data-theme="dark"] .payments-page .table-pagination,
    html[data-theme="dark"] .payments-page .table-pagination {
        background: rgba(255, 255, 255, 0.05) !important;
        border-top: none !important;
    }

    /* Modal styles for accept payment */
    .accept-payment-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        backdrop-filter: blur(4px);
    }

    .accept-payment-modal-overlay.show {
        display: flex;
    }

    .accept-payment-modal {
        background: #242831;
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 12px;
        padding: 0;
        max-width: 700px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        animation: modalFadeIn 0.3s ease-out;
    }

    @keyframes modalFadeIn {
        from {
            opacity: 0;
            transform: scale(0.9) translateY(-20px);
        }
        to {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    .accept-payment-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 24px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.12);
    }

    .accept-payment-modal-header h3 {
        color: rgba(255, 255, 255, 0.9);
        font-size: 1.25rem;
        font-weight: 600;
        margin: 0;
    }

    .accept-payment-modal-close {
        background: transparent;
        border: none;
        color: rgba(255, 255, 255, 0.6);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        transition: all 0.3s;
    }

    .accept-payment-modal-close:hover {
        background: rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.9);
    }

    .accept-payment-modal-body {
        padding: 24px;
    }

    .accept-payment-form-row {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-bottom: 20px;
    }

    .accept-payment-form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .accept-payment-form-group label {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 500;
    }

    .accept-payment-form-group input,
    .accept-payment-form-group select {
        padding: 10px 15px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 8px;
        color: #fefefe;
        font-size: 0.95rem;
        transition: all 0.3s;
    }

    .accept-payment-form-group input:focus,
    .accept-payment-form-group select:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        background: rgba(255, 255, 255, 0.08);
    }

    .accept-payment-form-group input::placeholder {
        color: rgba(255, 255, 255, 0.35);
    }

    .accept-payment-form-group select option {
        background: #1f2432;
        color: #f6f7ff;
    }

    .accept-payment-form-group.full-width {
        grid-column: 1 / -1;
    }

    .accept-payment-date-wrapper {
        position: relative;
        display: flex;
        align-items: center;
    }

    .accept-payment-date-wrapper input[type="date"] {
        flex: 1;
        padding: 10px 50px 10px 15px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 8px 0 0 8px;
        color: #fefefe;
    }

    .accept-payment-date-wrapper .btn-calendar {
        position: absolute;
        right: 0;
        width: 48px;
        height: 100%;
        padding: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 0 8px 8px 0;
        color: #ffffff;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
    }

    .accept-payment-date-wrapper .btn-calendar:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
    }

    .accept-payment-date-wrapper input[type="date"]::-webkit-datetime-edit-text,
    .accept-payment-date-wrapper input[type="date"]::-webkit-datetime-edit-month-field,
    .accept-payment-date-wrapper input[type="date"]::-webkit-datetime-edit-day-field,
    .accept-payment-date-wrapper input[type="date"]::-webkit-datetime-edit-year-field {
        color: #ffffff !important;
    }

    .accept-payment-modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        padding: 20px 24px;
        border-top: 1px solid rgba(255, 255, 255, 0.12);
    }

    .btn-modal-cancel {
        padding: 10px 20px;
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s;
    }

    .btn-modal-cancel:hover {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.3);
        color: #ffffff;
    }

    .btn-modal-save {
        padding: 10px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 8px;
        color: #ffffff;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    .btn-modal-save:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
        transform: translateY(-1px);
    }

    .btn-modal-save:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
    }
    .content-wrapper.payments-page {
        margin: 0 !important;
    }

    /* Скрыть границу у .content-wrapper.payments-page */
    #spa-content .content-wrapper.payments-page,
    body[data-theme="dark"] #spa-content .content-wrapper.payments-page,
    html[data-theme="dark"] #spa-content .content-wrapper.payments-page,
    [data-theme="dark"] #spa-content .content-wrapper.payments-page,
    .content-wrapper.payments-page {
        border: none !important;
        border-width: 0 !important;
        outline: none !important;
        box-shadow: none !important;
    }
    
    /* Также скрыть границу у всех дочерних элементов внутри payments-page */
    #spa-content .payments-page,
    body[data-theme="dark"] #spa-content .payments-page,
    html[data-theme="dark"] #spa-content .payments-page {
        border: none !important;
        outline: none !important;
    }
    .content-wrapper.payments-page{
        border-radius: 20px;
        }

</style>

<div class="content-wrapper payments-page">
    <!-- Filters Section -->
    <div class="payments-filters">
        <div class="payments-filters-row">
            <div class="payments-filters-group">
                <label>Резидент</label>
                <select id="filterResident">
                    <option value="all">Все</option>
                    <option value="1">Резидент 1</option>
                    <option value="2">Резидент 2</option>
                </select>
        </div>

            <div class="payments-filters-group">
                <label>Метод</label>
                <select id="filterMethod">
                    <option value="all">Все</option>
                    <option value="cash">Наличные</option>
                    <option value="card">CARD</option>
                    <option value="bank_transfer">Банк</option>
                    <option value="online">Онлайн</option>
                </select>
            </div>
            
            <div class="payments-filters-group">
                <label>От</label>
                <div class="date-input-wrapper">
                    <input type="date" id="filterDateFrom">
                    <button type="button" class="btn-calendar" onclick="openDatePicker('filterDateFrom')" title="Открыть календарь">
                        <i class="bi bi-calendar"></i>
                    </button>
                </div>
            </div>
            
            <div class="payments-filters-group">
                <label>До</label>
                <div class="date-input-wrapper">
                    <input type="date" id="filterDateTo">
                    <button type="button" class="btn-calendar" onclick="openDatePicker('filterDateTo')" title="Открыть календарь">
                        <i class="bi bi-calendar"></i>
                    </button>
                </div>
            </div>
            
            <div class="payments-filters-group">
                <label>Поиск</label>
                <input type="text" id="filterSearch" placeholder="№ чека / комментарий">
            </div>
        </div>
        
        <div class="payments-filters-actions">
            <button class="btn-filter" onclick="applyPaymentFilters()">
                <i class="bi bi-funnel"></i> Фильтр
            </button>
            <button class="btn-accept-payment" onclick="acceptPayment()">
                Принять платеж
            </button>
        </div>
    </div>

    <!-- Payments Table -->
    <div class="card">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Дата</th>
                            <th>Резидент</th>
                            <th>Сумма</th>
                            <th>Метод</th>
                            <th>Остаток</th>
                            <th>Ссылка</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody id="paymentsTable"></tbody>
                </table>
</div>

            <!-- Pagination -->
            <div class="table-pagination">
                <div class="pagination-controls">
                    <button class="btn-pagination" onclick="goToPaymentPage('prev')" disabled id="paymentPrevBtn">
                        <i class="bi bi-chevron-double-left"></i>
                    </button>
                    <button class="btn-pagination active" onclick="goToPaymentPage(1)" id="paymentCurrentPageBtn">1</button>
                    <button class="btn-pagination" onclick="goToPaymentPage('next')" disabled id="paymentNextBtn">
                        <i class="bi bi-chevron-double-right"></i>
                    </button>
                </div>
                <div class="pagination-info">
                    <span>Стр. <span id="paymentCurrentPage">1</span> из <span id="paymentTotalPages">1</span> · всего <span id="paymentTotalItems">0</span></span>
                </div>
                <div class="pagination-per-page">
                    <span>На</span>
                    <span>странице:</span>
                    <div class="custom-pag-select" id="customPaymentItemsPerPage">
                        <select id="paymentItemsPerPage" onchange="changePaymentItemsPerPage()" style="display: none;">
                            <option value="10">10</option>
                            <option value="25" selected>25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                        <div class="select-btn">
                            <span class="select-text">25</span>
                            <span class="arrow">▾</span>
                </div>
                        <div class="select-options">
                            <div class="select-option" data-value="10">10</div>
                            <div class="select-option selected" data-value="25">25</div>
                            <div class="select-option" data-value="50">50</div>
                            <div class="select-option" data-value="100">100</div>
                </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Accept Payment Modal -->
<div class="accept-payment-modal-overlay" id="acceptPaymentModal">
    <div class="accept-payment-modal">
        <div class="accept-payment-modal-header">
            <h3>Принять платеж</h3>
            <button class="accept-payment-modal-close" onclick="closeAcceptPaymentModal()" type="button">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>
        <div class="accept-payment-modal-body">
            <form id="acceptPaymentForm" onsubmit="savePayment(event)">
                <div class="accept-payment-form-row">
                    <div class="accept-payment-form-group">
                        <label for="paymentResident">Резидент</label>
                        <select id="paymentResident" required>
                            <option value="1">X / 2</option>
                            <option value="2">Резидент 2</option>
                            <option value="3">Резидент 3</option>
                        </select>
                    </div>
                    <div class="accept-payment-form-group">
                        <label for="paymentDate">Дата поступления</label>
                        <div class="accept-payment-date-wrapper">
                            <input type="date" id="paymentDate" required>
                            <button type="button" class="btn-calendar" onclick="openDatePicker('paymentDate')" title="Открыть календарь">
                                <i class="bi bi-calendar"></i>
                            </button>
                        </div>
                    </div>
                    <div class="accept-payment-form-group">
                        <label for="paymentAmount">Сумма</label>
                        <input type="number" id="paymentAmount" step="0.01" min="0" placeholder="0.00" required>
                    </div>
                    <div class="accept-payment-form-group">
                        <label for="paymentMethod">Метод</label>
                        <select id="paymentMethod" required>
                            <option value="cash" selected>CASH</option>
                            <option value="card">CARD</option>
                            <option value="bank_transfer">Банк</option>
                            <option value="online">Онлайн</option>
                        </select>
                    </div>
                </div>
                <div class="accept-payment-form-row">
                    <div class="accept-payment-form-group">
                        <label for="paymentReference">№/Референс</label>
                        <input type="text" id="paymentReference" placeholder="">
                    </div>
                    <div class="accept-payment-form-group">
                        <label for="paymentComment">Комментарий</label>
                        <input type="text" id="paymentComment" placeholder="">
                    </div>
                </div>
                <div class="accept-payment-form-row">
                    <div class="accept-payment-form-group full-width">
                        <label for="paymentCheckNumber">номер чека/платёжки</label>
                        <input type="text" id="paymentCheckNumber" placeholder="">
                    </div>
                </div>
            </form>
        </div>
        <div class="accept-payment-modal-footer">
            <button type="button" class="btn-modal-cancel" onclick="closeAcceptPaymentModal()">Отмена</button>
            <button type="button" class="btn-modal-save" onclick="savePayment(event)">Сохранить</button>
        </div>
    </div>
</div>

<script>
(function(){
    const methods = {
        bank_transfer: 'Банк',
        cash: 'Наличные',
        card: 'CARD',
        online: 'Онлайн'
    };
    
    // Store original data
    let allPayments = [];
    let filteredPayments = [];
    
    // Initialize data
    if (typeof TestData !== 'undefined' && TestData.payments) {
        allPayments = [...TestData.payments];
        filteredPayments = [...TestData.payments];
    } else {
        // Mock data
        allPayments = [
            {
                id: 1,
                date: '2025-11-21',
                resident: 'X/2',
                amount: 30.00,
                method: 'card',
                balance: 20.00,
                balanceType: 'advance',
                link: '123456'
            }
        ];
        filteredPayments = [...allPayments];
    }
    
    // Pagination state
    let paginationState = {
        currentPage: 1,
        itemsPerPage: 25,
        totalItems: 0,
        totalPages: 1
    };
    
    // Render table function
    function renderTable(payments) {
    const tbody = document.getElementById('paymentsTable');
        if (!tbody) return;
        
        // Update pagination state
        paginationState.totalItems = payments.length;
        paginationState.totalPages = Math.max(1, Math.ceil(paginationState.totalItems / paginationState.itemsPerPage));
        
        if (paginationState.currentPage > paginationState.totalPages) {
            paginationState.currentPage = paginationState.totalPages || 1;
        }
        
        // Get paginated data
        const startIndex = (paginationState.currentPage - 1) * paginationState.itemsPerPage;
        const endIndex = startIndex + paginationState.itemsPerPage;
        const pagePayments = payments.slice(startIndex, endIndex);
        
        if (pagePayments.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" class="text-center text-muted">Нет данных по текущим фильтрам</td></tr>';
        } else {
            tbody.innerHTML = pagePayments.map(p => {
                const date = p.date || '—';
                const resident = p.resident || p.userName || '—';
                const amount = typeof p.amount === 'number' ? p.amount.toFixed(2) : (p.amount || '0.00');
                const method = methods[p.method] || p.method || '—';
                const balance = typeof p.balance === 'number' ? p.balance.toFixed(2) : '0.00';
                const balanceType = p.balanceType || 'advance';
                const link = p.link || p.checkNumber || '—';
                
                return `<tr>
                    <td>${date}</td>
                    <td><strong>${resident}</strong></td>
                    <td class="amount-red">${amount} ₼</td>
                    <td>${method}</td>
                    <td>
                        ${balanceType === 'advance' ? `<span class="badge-advance">Аванс ${balance}</span>` : balance}
                    </td>
                    <td>${link}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewPayment(${p.id})">Открыть</button>
                    </td>
                </tr>`;
            }).join('');
        }
        
        updatePaginationUI();
    }
    
    // Update pagination UI
    function updatePaginationUI() {
        const currentPageEl = document.getElementById('paymentCurrentPage');
        const totalPagesEl = document.getElementById('paymentTotalPages');
        const totalItemsEl = document.getElementById('paymentTotalItems');
        const currentPageBtn = document.getElementById('paymentCurrentPageBtn');
        const prevBtn = document.getElementById('paymentPrevBtn');
        const nextBtn = document.getElementById('paymentNextBtn');
        
        if (currentPageEl) currentPageEl.textContent = paginationState.currentPage;
        if (totalPagesEl) totalPagesEl.textContent = paginationState.totalPages;
        if (totalItemsEl) totalItemsEl.textContent = paginationState.totalItems;
        if (currentPageBtn) currentPageBtn.textContent = paginationState.currentPage;
        if (prevBtn) prevBtn.disabled = paginationState.currentPage === 1;
        if (nextBtn) nextBtn.disabled = paginationState.currentPage === paginationState.totalPages;
    }
    
    // Pagination functions
    window.goToPaymentPage = function(page) {
        if (page === 'prev') {
            if (paginationState.currentPage > 1) {
                paginationState.currentPage--;
                renderTable(filteredPayments);
            }
        } else if (page === 'next') {
            if (paginationState.currentPage < paginationState.totalPages) {
                paginationState.currentPage++;
                renderTable(filteredPayments);
            }
        } else if (typeof page === 'number') {
            paginationState.currentPage = page;
            renderTable(filteredPayments);
        }
    };
    
    window.changePaymentItemsPerPage = function() {
        const select = document.getElementById('paymentItemsPerPage');
        if (select) {
            paginationState.itemsPerPage = parseInt(select.value);
            paginationState.currentPage = 1;
            renderTable(filteredPayments);
            updateCustomPaginationDropdown();
        }
    };
    
    // Filter functions
    window.applyPaymentFilters = function() {
        const resident = document.getElementById('filterResident').value;
        const method = document.getElementById('filterMethod').value;
        const dateFrom = document.getElementById('filterDateFrom').value;
        const dateTo = document.getElementById('filterDateTo').value;
        const search = document.getElementById('filterSearch').value.toLowerCase();
        
        filteredPayments = allPayments.filter(payment => {
            // Filter by resident
            if (resident && resident !== 'all') {
                if (payment.residentId && payment.residentId.toString() !== resident) {
                    return false;
                }
            }
            
            // Filter by method
            if (method && method !== 'all') {
                if (payment.method !== method) {
                    return false;
                }
            }
            
            // Filter by date range
            if (dateFrom) {
                if (payment.date < dateFrom) {
                    return false;
                }
            }
            if (dateTo) {
                if (payment.date > dateTo) {
                    return false;
                }
            }
            
            // Filter by search
            if (search) {
                const searchText = `${payment.link || ''} ${payment.checkNumber || ''} ${payment.comment || ''}`.toLowerCase();
                if (!searchText.includes(search)) {
                    return false;
                }
            }
            
            return true;
        });
        
        paginationState.currentPage = 1;
        renderTable(filteredPayments);
        
        if (typeof showSuccess === 'function') {
            showSuccess(`Найдено записей: ${filteredPayments.length}`);
        }
    };
    
    window.acceptPayment = function() {
        const modal = document.getElementById('acceptPaymentModal');
        if (modal) {
            modal.classList.add('show');
            
            // Set default date to today
            const dateInput = document.getElementById('paymentDate');
            if (dateInput) {
                const today = new Date().toISOString().split('T')[0];
                dateInput.value = today;
            }
            
            // Reset form
            const form = document.getElementById('acceptPaymentForm');
            if (form) {
                form.reset();
                // Set default values
                if (dateInput) {
                    const today = new Date().toISOString().split('T')[0];
                    dateInput.value = today;
                }
                const residentSelect = document.getElementById('paymentResident');
                if (residentSelect) {
                    residentSelect.value = '1'; // X / 2
                }
                const methodSelect = document.getElementById('paymentMethod');
                if (methodSelect) {
                    methodSelect.value = 'cash';
                }
            }
        }
    };
    
    window.closeAcceptPaymentModal = function() {
        const modal = document.getElementById('acceptPaymentModal');
        if (modal) {
            modal.classList.remove('show');
        }
    };
    
    window.savePayment = function(event) {
        if (event) {
            event.preventDefault();
        }
        
        const form = document.getElementById('acceptPaymentForm');
        if (!form) return;
        
        // Get form values
        const resident = document.getElementById('paymentResident').value;
        const date = document.getElementById('paymentDate').value;
        const amount = parseFloat(document.getElementById('paymentAmount').value);
        const method = document.getElementById('paymentMethod').value;
        const reference = document.getElementById('paymentReference').value;
        const comment = document.getElementById('paymentComment').value;
        const checkNumber = document.getElementById('paymentCheckNumber').value;
        
        // Validate required fields
        if (!resident || !date || !amount || !method) {
            if (typeof showWarning === 'function') {
                showWarning('Пожалуйста, заполните все обязательные поля!');
            }
            return;
        }
        
        if (amount <= 0) {
            if (typeof showWarning === 'function') {
                showWarning('Сумма должна быть больше нуля!');
            }
            return;
        }
        
        // Create payment object
        const paymentData = {
            resident,
            date,
            amount,
            method,
            reference,
            comment,
            checkNumber
        };
        
        console.log('Saving payment:', paymentData);
        
        // TODO: Save via API
        // Simulate API call
        setTimeout(() => {
            // Add to payments list
            const newPayment = {
                id: allPayments.length + 1,
                date: date,
                resident: document.getElementById('paymentResident').options[document.getElementById('paymentResident').selectedIndex].text,
                amount: amount,
                method: method,
                balance: amount,
                balanceType: 'advance',
                link: reference || checkNumber || ''
            };
            
            allPayments.unshift(newPayment);
            applyPaymentFilters();
            
            // Close modal
            closeAcceptPaymentModal();
            
            // Show success message
            if (typeof showSuccess === 'function') {
                showSuccess('Платеж успешно принят!');
            }
        }, 500);
    };
    
    // Close modal on overlay click
    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('acceptPaymentModal');
        if (modal) {
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeAcceptPaymentModal();
                }
            });
        }
    });
    
    window.viewPayment = function(id) {
        console.log('Opening payment view for ID:', id);
        
        // Загрузить страницу просмотра через fetch и вставить в SPA контейнер
        const viewUrl = `/admin/content/payment-view.html?id=${id}`;
        const contentContainer = document.getElementById('spa-content');
        
        if (!contentContainer) {
            console.error('SPA content container not found');
            window.location.href = viewUrl;
            return;
        }
        
        // Показать состояние загрузки
        contentContainer.innerHTML = '<div style="padding: 40px; text-align: center; color: rgba(255,255,255,0.8);"><i class="bi bi-hourglass-split" style="font-size: 2rem; margin-bottom: 10px;"></i><p>Загрузка...</p></div>';
        
        // Загрузить контент
        fetch(viewUrl)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.text();
            })
            .then(html => {
                // Вставить контент
                contentContainer.innerHTML = html;
                
                // Выполнить скрипты из загруженного контента
                const scripts = contentContainer.querySelectorAll('script');
                scripts.forEach(oldScript => {
                    const newScript = document.createElement('script');
                    Array.from(oldScript.attributes).forEach(attr => {
                        newScript.setAttribute(attr.name, attr.value);
                    });
                    newScript.appendChild(document.createTextNode(oldScript.innerHTML));
                    oldScript.parentNode.replaceChild(newScript, oldScript);
                });
                
                // Обновить заголовок страницы и breadcrumb
                updatePageHeaderForPaymentView(id);
                
                // Обновить URL в браузере
                if (window.history && window.history.pushState) {
                    window.history.pushState({ route: 'payment-view', id: id }, '', `#/payment-view?id=${id}`);
                }
                
                // Скроллить наверх
                contentContainer.scrollTop = 0;
                
                console.log('Payment view loaded successfully');
            })
            .catch(error => {
                console.error('Error loading payment view:', error);
                contentContainer.innerHTML = `<div style="padding: 40px; text-align: center; color: #ff6b6b;"><p>Ошибка загрузки страницы: ${error.message}</p><button onclick="window.location.reload()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; margin-top: 10px;">Перезагрузить</button></div>`;
            });
    };
    
    // Функция для обновления заголовка и breadcrumb при открытии просмотра платежа
    function updatePageHeaderForPaymentView(paymentId) {
        const pageTitle = document.querySelector('.page-title');
        const breadcrumb = document.querySelector('.breadcrumb');
        
        if (pageTitle) {
            pageTitle.textContent = 'Платежи';
        }
        
        if (breadcrumb) {
            breadcrumb.innerHTML = '<a href="#/dashboard">Главная</a> / <a href="#/payments">Финансы</a> / Платежи';
        }
    }
    
    window.openDatePicker = function(inputId) {
        const input = document.getElementById(inputId);
        if (input) {
            if (input.showPicker && typeof input.showPicker === 'function') {
                input.showPicker().catch(err => {
                    input.focus();
                    input.click();
                });
            } else {
                input.focus();
                input.click();
            }
        }
    };
    
    // Initialize custom pagination dropdown
    function updateCustomPaginationDropdown() {
        const customSelect = document.getElementById('customPaymentItemsPerPage');
        if (!customSelect) return;
        
        const nativeSelect = document.getElementById('paymentItemsPerPage');
        const selectText = customSelect.querySelector('.select-text');
        const options = customSelect.querySelectorAll('.select-option');
        
        if (nativeSelect && selectText) {
            const selectedValue = nativeSelect.value;
            selectText.textContent = selectedValue;
            options.forEach(opt => {
                opt.classList.remove('selected');
                if (opt.dataset.value === selectedValue) {
                    opt.classList.add('selected');
                }
            });
        }
    }
    
    function initCustomPaginationDropdown() {
        const customSelect = document.getElementById('customPaymentItemsPerPage');
        if (!customSelect || customSelect.dataset.initialized === 'true') return;
        customSelect.dataset.initialized = 'true';
        
        const nativeSelect = document.getElementById('paymentItemsPerPage');
        const selectBtn = customSelect.querySelector('.select-btn');
        const selectText = customSelect.querySelector('.select-text');
        const options = customSelect.querySelectorAll('.select-option');
        
        if (nativeSelect) {
            const selectedValue = nativeSelect.value;
            selectText.textContent = selectedValue;
            options.forEach(opt => {
                opt.classList.remove('selected');
                if (opt.dataset.value === selectedValue) {
                    opt.classList.add('selected');
                }
            });
        }
        
        selectBtn.onclick = function(e) {
            e.stopPropagation();
            customSelect.classList.toggle('open');
        };
        
        options.forEach(option => {
            option.onclick = function(e) {
                e.stopPropagation();
                const value = option.dataset.value;
                if (nativeSelect) {
                    nativeSelect.value = value;
                    nativeSelect.dispatchEvent(new Event('change', { bubbles: true }));
                }
                selectText.textContent = value;
                options.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                customSelect.classList.remove('open');
            };
        });
        
        document.addEventListener('click', function(e) {
            if (!customSelect.contains(e.target)) {
                customSelect.classList.remove('open');
            }
        });
    }
    
    // Auto-apply filters on input change
    document.addEventListener('DOMContentLoaded', function() {
        const filterInputs = ['filterResident', 'filterMethod', 'filterDateFrom', 'filterDateTo', 'filterSearch'];
        filterInputs.forEach(inputId => {
            const input = document.getElementById(inputId);
            if (input) {
                if (inputId === 'filterSearch') {
                    let searchTimeout;
                    input.addEventListener('input', function() {
                        clearTimeout(searchTimeout);
                        searchTimeout = setTimeout(applyPaymentFilters, 300);
                    });
                } else {
                    input.addEventListener('change', applyPaymentFilters);
                }
            }
        });
        
        // Initialize pagination dropdown
        setTimeout(() => {
            initCustomPaginationDropdown();
        }, 500);
    });
    
    // ПРИНУДИТЕЛЬНО ПРИМЕНИТЬ СЕРЫЙ ФОН В DARK THEME
    function applyDarkThemeStyles() {
        if (document.documentElement.getAttribute('data-theme') === 'dark' || 
            document.body.getAttribute('data-theme') === 'dark') {
            const filtersSection = document.querySelector('.payments-filters');
            
            if (filtersSection) {
                filtersSection.style.setProperty('background', '#242831', 'important');
                filtersSection.style.setProperty('background-color', '#242831', 'important');
                filtersSection.style.setProperty('border', 'none', 'important');
                filtersSection.style.setProperty('color', '#e4e6eb', 'important');
            }

            // Применить темный фон к карточке таблицы
            const card = document.querySelector('.payments-page .card');
            if (card) {
                card.style.setProperty('background', 'rgba(36, 40, 49, 0.95)', 'important');
                card.style.setProperty('background-color', 'rgba(36, 40, 49, 0.95)', 'important');
                card.style.setProperty('border', 'none', 'important');
            }

            const cardBody = document.querySelector('.payments-page .card-body');
            if (cardBody) {
                cardBody.style.setProperty('background', 'transparent', 'important');
                cardBody.style.setProperty('color', '#e4e6eb', 'important');
            }

            // Скрыть границу у .content-wrapper.payments-page
            const contentWrapper = document.querySelector('.content-wrapper.payments-page');
            if (contentWrapper) {
                contentWrapper.style.setProperty('border', 'none', 'important');
                contentWrapper.style.setProperty('border-width', '0', 'important');
                contentWrapper.style.setProperty('outline', 'none', 'important');
                contentWrapper.style.setProperty('box-shadow', 'none', 'important');
            }

            // Применить серый фон к select и option элементам
            const selectElements = document.querySelectorAll('.payments-filters-group select');
            selectElements.forEach(select => {
                select.style.setProperty('background', 'rgba(255, 255, 255, 0.05)', 'important');
                select.style.setProperty('background-color', 'rgba(255, 255, 255, 0.05)', 'important');
                select.style.setProperty('color', '#fefefe', 'important');
                
                // Применить стили к option элементам
                const options = select.querySelectorAll('option');
                options.forEach(option => {
                    option.style.setProperty('background', '#242831', 'important');
                    option.style.setProperty('background-color', '#242831', 'important');
                    option.style.setProperty('color', '#f6f7ff', 'important');
                });
            });

            // Инъекция CSS для белого плейсхолдера date input
            const dateInputStyleId = 'payments-date-input-placeholder-white';
            if (!document.getElementById(dateInputStyleId)) {
                const style = document.createElement('style');
                style.id = dateInputStyleId;
                style.textContent = `
                    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-text,
                    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-month-field,
                    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-day-field,
                    [data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-year-field,
                    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-text,
                    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-month-field,
                    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-day-field,
                    body[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-year-field,
                    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-text,
                    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-month-field,
                    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-day-field,
                    html[data-theme="dark"] .date-input-wrapper input[type="date"]::-webkit-datetime-edit-year-field {
                        color: #ffffff !important;
                    }
                `;
                document.head.appendChild(style);
            }
        }
    }
    
    // Функция для скрытия границы у content-wrapper
    function hideContentWrapperBorder() {
        const contentWrapper = document.querySelector('.content-wrapper.payments-page');
        if (contentWrapper) {
            contentWrapper.style.setProperty('border', 'none', 'important');
            contentWrapper.style.setProperty('border-width', '0', 'important');
            contentWrapper.style.setProperty('outline', 'none', 'important');
            contentWrapper.style.setProperty('box-shadow', 'none', 'important');
        }
    }
    
    // Применить сразу
    applyDarkThemeStyles();
    hideContentWrapperBorder();
    
    // Применить после загрузки DOM
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            applyDarkThemeStyles();
            setTimeout(hideContentWrapperBorder, 100);
            setTimeout(hideContentWrapperBorder, 500);
            setTimeout(hideContentWrapperBorder, 1000);
        });
    }
    
    // Применить с задержкой на случай, если стили загружаются асинхронно
    setTimeout(() => {
        applyDarkThemeStyles();
        hideContentWrapperBorder();
    }, 100);
    setTimeout(() => {
        applyDarkThemeStyles();
        hideContentWrapperBorder();
    }, 500);
    setTimeout(() => {
        applyDarkThemeStyles();
        hideContentWrapperBorder();
    }, 1000);

    // Повторно применять стили при открытии select (для выпадающих списков)
    document.addEventListener('DOMContentLoaded', function() {
        const selectElements = document.querySelectorAll('.payments-filters-group select');
        selectElements.forEach(select => {
            select.addEventListener('mousedown', function() {
                setTimeout(applyDarkThemeStyles, 10);
            });
            select.addEventListener('focus', function() {
                setTimeout(applyDarkThemeStyles, 10);
            });
            select.addEventListener('change', function() {
                setTimeout(applyDarkThemeStyles, 10);
            });
        });
    });
    
    // Initial render
    renderTable(filteredPayments);
})();
</script>
